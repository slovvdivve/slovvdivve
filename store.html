<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
<title>EdQuest — Магазин</title>
<link rel="stylesheet" href="css/style.css">
</head>
<body>
<div class="bg"><div class="grid"></div></div>

<div class="layout">
  <aside class="sidebar">
    <a id="logoLink" href="index.html" class="brand"><div class="logo"></div> EdQuest</a>
    <nav class="nav">
      <a data-key="home" href="index.html">🏠 Главная</a>
      <a data-key="game" href="game.html">▶️ Игра</a>
      <a data-key="profile" href="profile.html">👤 Профиль</a>
      <a data-key="store" href="store.html">🛍️ Магазин</a>
      <a data-key="ref" href="referrals.html">🤝 Рефералы</a>
      <a data-key="settings" href="settings.html">⚙️ Настройки</a>
      <a data-key="help" href="help.html">❓ Помощь</a>
    </nav>
    <div class="side-stat">
      <div class="stat-chip">🎓 Уровень: <b id="uiLevel">1</b></div>
      <div class="xp-bar"><div class="xp-fill" id="uiXpFill"></div></div>
      <div class="stat-chip">🪙 Монеты: <b id="uiCoins">0</b></div>
      <div class="footer-mini">© EdQuest • v9.1.3</div>
    </div>
  </aside>

  <main class="content">
    <div class="container">
      <section class="panel">
        <div class="title">🛍️ Магазин</div>
        <p class="muted">Обменивай монеты на наборы стикеров.</p>
        <div id="shopGrid" class="gridgap"></div>
      </section>
    </div>
  </main>
</div>

<footer class="dock">
  <div class="row">
    <a data-key="home" href="index.html">🏠<span>Главная</span></a>
    <a data-key="game" href="game.html">▶️<span>Игра</span></a>
    <a data-key="profile" href="profile.html">👤<span>Профиль</span></a>
    <a data-key="store" href="store.html">🛍️<span>Магазин</span></a>
    <a data-key="ref" href="referrals.html">🤝<span>Рефералы</span></a>
  </div>
</footer>

<script src="js/main.js"></script>
<script>
const { state, Save, updSide, toast } = window.__edq__;
const STICKERS=[
  {id:'s1',name:'Учёба — Базовый',icon:'📘',price:80},
  {id:'s2',name:'Математика — Мемы',icon:'➗😄',price:120},
  {id:'s3',name:'Русский — Смайлы',icon:'📝✨',price:100},
];
function renderShop(){
  const root=document.getElementById('shopGrid'); if(!root) return; root.innerHTML='';
  for(const s of STICKERS){
    const owned=state.shop.owned?.includes(s.id);
    const el=document.createElement('div'); el.className='stat-chip';
    el.innerHTML=`<div style="font-size:28px">${s.icon}</div>
      <div style="flex:1"><b>${s.name}</b><div class="muted">Цена: ${s.price} 🪙</div></div>
      <button class="btn ${owned?'':'primary'}" ${owned?'disabled':''}>${owned?'✅ Владение':'Купить'}</button>`;
    el.querySelector('button').addEventListener('click',()=>{
      if(owned) return;
      if(state.profile.coins < s.price){ toast('Не хватает монет'); return; }
      state.profile.coins -= s.price;
      state.shop.owned.push(s.id);
      Save.save(state); renderShop(); updSide(); toast('Куплено!');
    });
    root.appendChild(el);
  }
}
window.addEventListener('load',()=>{ renderShop(); updSide(); });
</script>
</body>
</html>
